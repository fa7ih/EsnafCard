@{
    ViewData["Title"] = "Ödeme Al";
}

<h2 class="mb-4">
    <i class="bi bi-cash-coin"></i> Ödeme Al
</h2>

<div class="row">
    <div class="col-md-6">
        <div class="card">
            <div class="card-header bg-success text-white">
                <h5 class="mb-0">
                    <i class="bi bi-keyboard"></i> Manuel Giriş
                </h5>
            </div>
            <div class="card-body">
                <form method="post" asp-action="ProcessPayment">
                    <div class="mb-3">
                        <label class="form-label">
                            <i class="bi bi-credit-card"></i> Kart Numarası
                        </label>
                        <input type="text" name="cardNumber" class="form-control form-control-lg text-center" 
                               placeholder="12345678" maxlength="8" pattern="\d{8}" required 
                               style="font-size: 1.5rem; letter-spacing: 3px;">
                        <small class="text-muted">8 haneli kart numarasını girin</small>
                    </div>

                    <div class="mb-3">
                        <label class="form-label">
                            <i class="bi bi-cash-stack"></i> Ödeme Tutarı (TL)
                        </label>
                        <input type="number" name="amount" class="form-control form-control-lg" 
                               step="0.01" min="0.01" required placeholder="0.00">
                    </div>

                    <button type="submit" class="btn btn-success w-100 btn-lg">
                        <i class="bi bi-check-circle"></i> Ödemeyi Onayla
                    </button>
                </form>
            </div>
        </div>
    </div>

    <div class="col-md-6">
        <div class="card">
            <div class="card-header bg-primary text-white">
                <h5 class="mb-0">
                    <i class="bi bi-camera"></i> Kart Fotoğrafı ile Ödeme (OCR)
                </h5>
            </div>
            <div class="card-body">
                <form method="post" asp-action="ProcessPaymentWithOcr" enctype="multipart/form-data">
                    <div class="mb-3">
                        <label class="form-label">
                            <i class="bi bi-image"></i> Kart Fotoğrafı
                        </label>
                        <input type="file" name="cardImage" class="form-control" 
                               accept="image/*" required capture="environment">
                        <small class="text-muted">Kart numarasının görünür olduğu bir fotoğraf çekin</small>
                    </div>

                    <div class="mb-3">
                        <label class="form-label">
                            <i class="bi bi-cash-stack"></i> Ödeme Tutarı (TL)
                        </label>
                        <input type="number" name="amount" class="form-control form-control-lg" 
                               step="0.01" min="0.01" required placeholder="0.00">
                    </div>

                    <button type="submit" class="btn btn-primary w-100 btn-lg">
                        <i class="bi bi-upc-scan"></i> OCR ile Ödeme Al
                    </button>
                </form>

                <div class="alert alert-info mt-3">
                    <i class="bi bi-info-circle"></i>
                    <small>
                        <strong>Not:</strong> OCR özelliği kart numarasını otomatik olarak okur. 
                        Fotoğraf net olmalı ve kart numarası açıkça görünmelidir.
                    </small>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="card mt-4">
    <div class="card-header bg-warning">
        <h5 class="mb-0">
            <i class="bi bi-exclamation-triangle"></i> Önemli Bilgiler
        </h5>
    </div>
    <div class="card-body">
        <div class="row">
            <div class="col-md-6">
                <h6>Ödeme İşlemi Nasıl Çalışır?</h6>
                <ol>
                    <li>Kart numarasını manuel girin veya fotoğraf çekin</li>
                    <li>Ödeme tutarını belirleyin</li>
                    <li>Sistem kartın size ait olup olmadığını kontrol eder</li>
                    <li>Kartın bakiyesini kontrol eder</li>
                    <li>Yeterli bakiye varsa, tutar karttan düşülür</li>
                    <li>İşlem kayıt altına alınır</li>
                </ol>
            </div>
            <div class="col-md-6">
                <h6>Dikkat Edilmesi Gerekenler</h6>
                <ul>
                    <li>Kart numarası mutlaka 8 haneli olmalıdır</li>
                    <li>Kart size ait olmalıdır</li>
                    <li>Kart aktif durumda olmalıdır</li>
                    <li>Kartın yeterli bakiyesi olmalıdır</li>
                    <li>Her işlem sistem tarafından loglanır</li>
                    <li>OCR ile okuma %100 doğru olmayabilir</li>
                </ul>
            </div>
        </div>
    </div>
</div>

<div class="mt-3">
    <a href="/User" class="btn btn-secondary">
        <i class="bi bi-arrow-left"></i> Ana Sayfaya Dön
    </a>
    <a href="/User/Transactions" class="btn btn-info">
        <i class="bi bi-clock-history"></i> İşlem Geçmişi
    </a>
</div>
